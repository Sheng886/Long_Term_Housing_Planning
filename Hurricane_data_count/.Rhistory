state <- over(point, state_polygons)
# Return the state name or NA if not found
if (is.na(state)) {
return(NA)
} else {
return(state_names[state])
}
}
# Example usage: Replace with your coordinates
longitude <- -77.0369  # Longitude (e.g., Washington, D.C.)
latitude <- 38.9072    # Latitude (e.g., Washington, D.C.)
state <- get_state(longitude, latitude)
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -82,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -82 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.5,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.5 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.5,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.5 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -80.5,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -80.5 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -80.8,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -80.8 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.2,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.2 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.3,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.3 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.4,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.4 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = Longitude)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black", alpha = 0.7) +
labs(title = "Distribution of Landfalls by Longitude", x = "Longitude", y = "Frequency") +
theme_minimal()
get_state <- function(lon, lat) {
# Load US state boundaries
states_map <- map("state", plot = FALSE, fill = TRUE)
# Create spatial polygons for states
state_names <- sapply(strsplit(states_map$names, ":"), `[`, 1)
state_polygons <- map2SpatialPolygons(states_map, IDs = state_names, proj4string = CRS("+proj=longlat +datum=WGS84"))
# Create a spatial point for the given coordinates
point <- SpatialPoints(matrix(c(lon, lat), ncol = 2), proj4string = CRS("+proj=longlat +datum=WGS84"))
# Check which state the point falls into
state <- over(point, state_polygons)
# Return the state name or NA if not found
if (is.na(state)) {
return(NA)
} else {
return(state_names[state])
}
}
# Example usage: Replace with your coordinates
longitude <- -77.0369  # Longitude (e.g., Washington, D.C.)
latitude <- 38.9072    # Latitude (e.g., Washington, D.C.)
state <- get_state(longitude, latitude)
# Load US state boundaries
states <- st_as_sf(maps::map("state", fill = TRUE, plot = FALSE))
library(maptools)
lonlat_to_state_sp <- function(pointsDF) {
# Prepare SpatialPolygons object with one SpatialPolygon
# per state (plus DC, minus HI & AK)
states <- map('state', fill=TRUE, col="transparent", plot=FALSE)
IDs <- sapply(strsplit(states$names, ":"), function(x) x[1])
states_sp <- map2SpatialPolygons(states, IDs=IDs,
proj4string=CRS("+proj=longlat +datum=WGS84"))
# Convert pointsDF to a SpatialPoints object
pointsSP <- SpatialPoints(pointsDF,
proj4string=CRS("+proj=longlat +datum=WGS84"))
# Use 'over' to get _indices_ of the Polygons object containing each point
indices <- over(pointsSP, states_sp)
# Return the state names of the Polygons object containing each point
stateNames <- sapply(states_sp@polygons, function(x) x@ID)
stateNames[indices]
}
# Test the function using points in Wisconsin and Oregon.
testPoints <- data.frame(x = c(-90, -120), y = c(44, 44))
lonlat_to_state_sp(testPoints)
[1] "wisconsin" "oregon" # IT WORKS
View(testPoints)
lonlat_to_state_sp <- function(pointsDF) {
# Prepare SpatialPolygons object with one SpatialPolygon
states <- map('state', fill=TRUE, col="transparent", plot=FALSE)
IDs <- sapply(strsplit(states$names, ":"), function(x) x[1])
states_sp <- map2SpatialPolygons(states, IDs=IDs,
proj4string=CRS("+proj=longlat +datum=WGS84"))
# Convert pointsDF to a SpatialPoints object
pointsSP <- SpatialPoints(pointsDF,
proj4string=CRS("+proj=longlat +datum=WGS84"))
# Use 'over' to get _indices_ of the Polygons object containing each point
indices <- over(pointsSP, states_sp)
# Return the state names of the Polygons object containing each point
stateNames <- sapply(states_sp@polygons, function(x) x@ID)
stateNames[indices]
}
# Test the function using points in Wisconsin and Oregon.
landfall_Gulf <- data.frame(x = Hurricane_data_Gulf$Longitude, y = Hurricane_data_Gulf$Latitude)
landfall_Atlantic <- data.frame(x = Hurricane_data_Atlantic, y = Hurricane_data_Atlantic$Latitude)
lonlat_to_state_sp(landfall_Gulf)
lonlat_to_state_sp(landfall_Atlantic)
landfall_Atlantic <- data.frame(x = Hurricane_data_Atlantic$Longitude, y = Hurricane_data_Atlantic$Latitude)
lonlat_to_state_sp(landfall_Atlantic)
View(get_state)
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.4,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.4 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(zoo)
library(dplyr)
library(ggplot2)
library(maps)
library(sp)
library(maptools)
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.4,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.4 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
lonlat_to_state_sp <- function(pointsDF) {
# Prepare SpatialPolygons object with one SpatialPolygon
states <- map('state', fill=TRUE, col="transparent", plot=FALSE)
IDs <- sapply(strsplit(states$names, ":"), function(x) x[1])
states_sp <- map2SpatialPolygons(states, IDs=IDs, proj4string=CRS("+proj=longlat +datum=WGS84"))
# Convert pointsDF to a SpatialPoints object
pointsSP <- SpatialPoints(pointsDF, proj4string=CRS("+proj=longlat +datum=WGS84"))
# Use 'over' to get _indices_ of the Polygons object containing each point
indices <- over(pointsSP, states_sp)
# Return the state names of the Polygons object containing each point
stateNames <- sapply(states_sp@polygons, function(x) x@ID)
stateNames[indices]
}
# Test the function using points in Wisconsin and Oregon.
landfall_Gulf <- data.frame(x = Hurricane_data_Gulf$Longitude, y = Hurricane_data_Gulf$Latitude)
landfall_Atlantic <- data.frame(x = Hurricane_data_Atlantic$Longitude, y = Hurricane_data_Atlantic$Latitude)
lonlat_to_state_sp(landfall_Atlantic)
ggplot(df, aes(x = column_name)) +
geom_histogram(binwidth = 2, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = SS)) +
geom_histogram(binwidth = 2, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
View(Hurricane_data_Gulf)
ggplot(Hurricane_data_Gulf, aes(x = SS)) +
geom_histogram()
ggplot(Hurricane_data_Gulf, aes(x = SS)) +
geom_histogram(binwidth = 1.5, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = SS)) +
geom_histogram(binwidth = 1, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = SS)) +
geom_histogram(binwidth = 0.5, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = SS)) +
geom_histogram(binwidth = 1.5, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
ggplot(Hurricane_data_Gulf, aes(x = SS)) +
geom_histogram(binwidth = 1, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
# SS for Gulf
ggplot(Hurricane_data_Gulf, aes(x = SS)) +
geom_histogram(binwidth = 1, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
# SS for Atlantic
ggplot(Hurricane_data_Atlantic, aes(x = SS)) +
geom_histogram(binwidth = 1, fill = "lightblue", color = "black", alpha = 0.7) +
labs(title = "Histogram of Column", x = "Column Values", y = "Frequency") +
theme_minimal()
library(geosphere)
# Load US state boundaries using the 'maps' package
states <- st_as_sf(maps::map("state", plot = FALSE, fill = TRUE))
# get usa polygon data
# http://eric.clst.org/tech/usgeojson/
usa <- geojson_read(
"http://eric.clst.org/assets/wiki/uploads/Stuff/gz_2010_us_040_00_500k.json",
what = "sp"
)
lonlat_to_state_sp <- function(pointsDF) {
# Prepare SpatialPolygons object with one SpatialPolygon
# per state (plus DC, minus HI & AK)
states <- map('state', fill=TRUE, col="transparent", plot=FALSE)
IDs <- sapply(strsplit(states$names, ":"), function(x) x[1])
states_sp <- map2SpatialPolygons(states, IDs=IDs,
proj4string=CRS("+proj=longlat +datum=WGS84"))
# Convert pointsDF to a SpatialPoints object
pointsSP <- SpatialPoints(pointsDF,
proj4string=CRS("+proj=longlat +datum=WGS84"))
# Use 'over' to get _indices_ of the Polygons object containing each point
indices <- over(pointsSP, states_sp)
# Return the state names of the Polygons object containing each point
stateNames <- sapply(states_sp@polygons, function(x) x@ID)
stateNames[indices]
}
# Test the function using points in Wisconsin and Oregon.
testPoints <- data.frame(x = c(-90, -120), y = c(44, 44))
lonlat_to_state_sp(testPoints)
lonlat_to_state_sp <- function(pointsDF) {
# Prepare SpatialPolygons object with one SpatialPolygon
# per state (plus DC, minus HI & AK)
states <- map('state', fill=TRUE, col="transparent", plot=FALSE)
IDs <- sapply(strsplit(states$names, ":"), function(x) x[1])
states_sp <- map2SpatialPolygons(states, IDs=IDs,
proj4string=CRS("+proj=longlat +datum=WGS84"))
# Convert pointsDF to a SpatialPoints object
pointsSP <- SpatialPoints(pointsDF,
proj4string=CRS("+proj=longlat +datum=WGS84"))
# Use 'over' to get _indices_ of the Polygons object containing each point
indices <- over(pointsSP, states_sp)
# Return the state names of the Polygons object containing each point
stateNames <- sapply(states_sp@polygons, function(x) x@ID)
stateNames[indices]
}
# Test the function using points in Wisconsin and Oregon.
testPoints <- data.frame(x = Hurricane_data_Gulf$Longitude, y = Hurricane_data_Gulf$Latitude)
lonlat_to_state_sp(testPoints)
knitr::opts_chunk$set(echo = TRUE)
library(zoo)
library(dplyr)
library(ggplot2)
library(maps)
library(sp)
library(maptools)
library(geosphere)
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.4,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.4 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(zoo)
library(dplyr)
library(ggplot2)
library(maps)
library(sp)
library(maptools)
library(geosphere)
Hurricane_ = read.csv("Hurricane_track/Hurricane_landfall_windspeed.csv", as.is=T)
year <- sub(".*/.*/", "", Hurricane_$year)
year = substr(year, 1, 4)
Hurricane_$year = year
Hurricane_$Latitude = as.numeric(substr(Hurricane_$Latitude, 1, 4))
Hurricane_$Longitude = as.numeric(substr(Hurricane_$Longitude, 1, 4))
Hurricane_$Latitude = Hurricane_$Latitude
Hurricane_$Longitude = Hurricane_$Longitude*-1
Hurricane_data_Gulf = Hurricane_[Hurricane_$Longitude < -81.4,]
Hurricane_data_Atlantic = Hurricane_[Hurricane_$Longitude >= -81.4 & Hurricane_$Longitude <= -70,]
# Create a base map of the USA
usa_map <- map_data("usa")
# Plot the map with the coordinates
ggplot() +
geom_polygon(data = usa_map, aes(x = long, y = lat, group = group), fill = "lightgray", color = "black") +
geom_point(data = Hurricane_data_Gulf, aes(x = Longitude, y = Latitude), color = "purple", size = 1) +
geom_point(data = Hurricane_data_Atlantic, aes(x = Longitude, y = Latitude), color = "orange", size = 1) +
coord_fixed(1.3) +  # Fix aspect ratio
labs(title = "Landfall", x = "Longitude", y = "Latitude") +
theme_minimal()
