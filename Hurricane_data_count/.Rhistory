beta0 ~ normal(0, 1000);
beta1 ~ normal(0, 1000);
beta2 ~ normal(0, 1000);
beta3 ~ normal(0, 1000);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta2 * SOI + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
IND = IND,
AMO = AMO,
SOI = SOI,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 12000, warmup = 2000, chains = 2, seed = 1234)
# Print summary of the results
print(fit)
knitr::opts_chunk$set(echo = TRUE)
library(zoo)
library(dplyr)
library(ggplot2)
library(maps)
library(sp)
library(maptools)
library(geosphere)
library(MASS)
library(viridis)
library(rstan)
library(readr)
# Set a seed for reproducibility
set.seed(123)
# Load data from a CSV file
data <- read_csv("data_counts/data_all_counts.csv")
# Input
N <- nrow(data)
NAO <- data$NAO
AMO <- data$AMO
SOI <- data$SOI
# Response
observed_data <- data$LANDFALL_COUNTS
# Define the model
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
vector[N] SOI;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta2;
real beta3;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 1000);
beta1 ~ normal(0, 1000);
beta2 ~ normal(0, 1000);
beta3 ~ normal(0, 1000);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta2 * SOI + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
SOI = SOI,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 12000, warmup = 2000, chains = 2, seed = 1234)
# Print summary of the results
print(fit)
# Install and load the required package
# install.packages("rstanarm")
library(rstanarm)
library(rstan)
library(readr)
# Set a seed for reproducibility
set.seed(123)
# Load data from a CSV file
data <- read_csv("/mnt/data/data_all_counts.csv")
# Set a seed for reproducibility
set.seed(123)
# Load data from a CSV file
data <- read_csv("data_counts/data_all_counts.csv")
# Input
N <- nrow(data)
NAO <- data$NAO
AMO <- data$AMO
SOI <- data$SOI
# Response
observed_data <- data$LANDFALL_COUNTS
# Define the model with improved priors and adjusted prior scales
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
vector[N] SOI;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta2;
real beta3;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 10);
beta1 ~ normal(0, 10);
beta2 ~ normal(0, 10);
beta3 ~ normal(0, 10);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta2 * SOI + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
SOI = SOI,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 2000, warmup = 1000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
library(bayesplot)
mcmc_areas(as.array(fit), pars = c("beta0", "beta1", "beta2", "beta3"))
fitted_values <- extract(fit)$lambda_mean
residuals <- observed_data - fitted_values
plot(fitted_values, residuals, xlab = "Fitted Values", ylab = "Residuals")
fitted_values <- extract(fit)$lambda_mean
residuals <- observed_data - fitted_values
plot(fitted_values, residuals, xlab = "Fitted Values", ylab = "Residuals")
plot(fitted_values, residuals, xlab = "Fitted Values", ylab = "Residuals")
abline(h = 0, col = "red"))
library(bayesplot)
mcmc_areas(as.array(fit), pars = c("beta0", "beta1", "beta2", "beta3"))
fitted_values <- extract(fit)$lambda_mean
residuals <- observed_data - fitted_values
plot(fitted_values, residuals, xlab = "Fitted Values", ylab = "Residuals")
fitted_values
residuals
y_rep <- posterior_predict(fit)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 2000, warmup = 1000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
```
traceplot(fit$lp__)
# Print summary of the results
print(fit)
# Define the model with improved priors and adjusted prior scales
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta2;
real beta3;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 10);
beta1 ~ normal(0, 10);
beta3 ~ normal(0, 10);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 2000, warmup = 1000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
# Define the model with improved priors and adjusted prior scales
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta3;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 10);
beta1 ~ normal(0, 10);
beta3 ~ normal(0, 10);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 2000, warmup = 1000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
# Set a seed for reproducibility
set.seed(123)
# Load data from a CSV file
data <- read_csv("data_counts/data_all_counts.csv")
# Input
N <- nrow(data)
NAO <- data$NAO
AMO <- data$AMO
SOI <- data$SOI
# Response
observed_data <- data$LANDFALL_COUNTS
# Define the model with improved priors and adjusted prior scales
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
vector[N] SOI;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta2;
real beta3;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 10);
beta1 ~ normal(0, 10);
beta2 ~ normal(0, 10);
beta3 ~ normal(0, 10);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta2 * SOI + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
SOI = SOI,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 4000, warmup = 2000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
# Define the model with improved priors and adjusted prior scales
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta3;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 10);
beta1 ~ normal(0, 10);
beta3 ~ normal(0, 10);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 4000, warmup = 2000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
# Set a seed for reproducibility
set.seed(123)
# Load data from a CSV file
data <- read_csv("data_counts/data_all_counts.csv")
# Input
N <- nrow(data)
NAO <- data$NAO
AMO <- data$AMO
SOI <- data$SOI
ICE <- data$ICELAND_SLP
# Response
observed_data <- data$LANDFALL_COUNTS
# Define the model with improved priors and adjusted prior scales
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
vector[N] SOI;
vector[N] ICE;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta2;
real beta3;
real beta4;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 10);
beta1 ~ normal(0, 10);
beta2 ~ normal(0, 10);
beta3 ~ normal(0, 10);
beta4 ~ normal(0, 10);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta2 * SOI + beta3 * AMO + beta4 * ICE);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
SOI = SOI,
ICE = ICE,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 4000, warmup = 2000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
# Response
observed_data <- data$HURRICANE
# Define the model with improved priors and adjusted prior scales
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
vector[N] SOI;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta2;
real beta3;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 10);
beta1 ~ normal(0, 10);
beta2 ~ normal(0, 10);
beta3 ~ normal(0, 10);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta2 * SOI + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
SOI = SOI,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 2000, warmup = 1000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
traceplot(fit, pars = 'lp__')
# Set a seed for reproducibility
set.seed(123)
# Load data from a CSV file
data <- read_csv("data_counts/data_all_counts.csv")
# Input
N <- nrow(data)
NAO <- data$NAO
AMO <- data$AMO
SOI <- data$SOI
# Response
observed_data <- data$LANDFALL_COUNTS
# Define the model with improved priors and adjusted prior scales
model_code <- "
data {
int<lower=0> N;
vector[N] NAO;
vector[N] AMO;
vector[N] SOI;
int<lower=0> observed_data[N];
}
parameters {
real beta0;
real beta1;
real beta2;
real beta3;
}
model {
vector[N] lambda;
// Priors
beta0 ~ normal(0, 10);
beta1 ~ normal(0, 10);
beta2 ~ normal(0, 10);
beta3 ~ normal(0, 10);
// Linear combination for lambda
lambda = exp(beta0 + beta1 * NAO + beta2 * SOI + beta3 * AMO);
// Likelihood
observed_data ~ poisson(lambda);
}
"
# Compile the model
stan_model <- stan_model(model_code = model_code, save_dso = TRUE)
# Prepare data list for Stan
stan_data <- list(
N = N,
NAO = NAO,
AMO = AMO,
SOI = SOI,
observed_data = observed_data
)
# Run MCMC sampling
fit <- sampling(stan_model, data = stan_data, iter = 2000, warmup = 1000, chains = 4, seed = 1234)
# Print summary of the results
print(fit)
traceplot(fit)
traceplot(fit, pars = 'lp__')
